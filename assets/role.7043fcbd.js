var e=Object.assign;import{f as s,u as a,c as t,g as l,a as o,r as i}from"./role.0a4b3fa5.js";import{s as r,d as n,j as c,r as d,o as m,l as u,t as b,b as k,c as p,e as v,f,w as h,i as y}from"./index.597464c9.js";import"./vendor.be963390.js";var C=n({name:"system-role",setup(){const n=c(null),k=d({visible:!1,loading:!1,rules:{roleName:{required:!0,type:"string",message:"请输入角色名称",trigger:"blur"}},form:{}}),p=a(k,{C:t,R:l,U:o,D:i},n),v=c([{key:"roleName",label:"角色名称",component:"Input"},{key:"note",label:"角色描述",component:"InputTextArea"}]);m((()=>{h()}));const f=d({id:null,visible:!1,data:[],checkedKeys:[]}),h=async()=>{const e=await u();f.data=e?e.data:[]};return e(e(e({},b(k)),p),{schemas:v,columns:[{title:"角色名称",dataIndex:"roleName",width:"40%"},{title:"角色描述",dataIndex:"note"},{title:"操作",width:"200px",slots:{customRender:"operation"}}],terms:[{key:"roleName",label:"角色名称",component:"Input"}],tableRef:n,action:s,resource:f,setResource:async e=>{f.id=e,f.visible=!0;const s=await(a=e,r.get(`roleMenu/roleId/${a}`));var a;const t=s?s.data.map((e=>e.resourceId)):[];f.checkedKeys=t},replaceFields:{key:"id"},onCheck:e=>{f.checkedKeys=e},submitRole:async()=>{var e,s;await(e=f.id,s=f.checkedKeys,r.post(`roleMenu/saveOrUpdate/${e}`,s))&&(f.visible=!1)}})}});const K=y("编辑"),g=y("设置菜单"),R=y("删除");C.render=function(e,s,a,t,l,o){const i=k("a-button"),r=k("lv-table"),n=k("lv-modal-form"),c=k("a-tree"),d=k("a-modal");return p(),v("div",null,[f(r,{ref:"tableRef",title:"角色管理",columns:e.columns,terms:e.terms,action:e.action,onCreate:s[1]||(s[1]=s=>e.handle())},{operation:h((({record:s})=>[f(i,{type:"link",size:"small",onClick:a=>e.handle(s.id)},{default:h((()=>[K])),_:2},1032,["onClick"]),f(i,{type:"link",size:"small",onClick:a=>e.setResource(s.id)},{default:h((()=>[g])),_:2},1032,["onClick"]),f(i,{type:"link",size:"small",onClick:a=>e.remove(s.id)},{default:h((()=>[R])),_:2},1032,["onClick"])])),_:1},8,["columns","terms","action"]),f(n,{form:e.form,"onUpdate:form":s[2]||(s[2]=s=>e.form=s),visible:e.visible,"onUpdate:visible":s[3]||(s[3]=s=>e.visible=s),schemas:e.schemas,title:"用户信息",rules:e.rules,column:1,onSubmit:e.submit},null,8,["form","visible","schemas","rules","onSubmit"]),f(d,{visible:e.resource.visible,"onUpdate:visible":s[5]||(s[5]=s=>e.resource.visible=s),title:"资源设置","destroy-on-close":"",onOk:e.submitRole},{default:h((()=>[f(c,{checkedKeys:e.resource.checkedKeys,"onUpdate:checkedKeys":s[4]||(s[4]=s=>e.resource.checkedKeys=s),"replace-fields":e.replaceFields,checkable:"","tree-data":e.resource.data,onCheck:e.onCheck},null,8,["checkedKeys","replace-fields","tree-data","onCheck"])])),_:1},8,["visible","onOk"])])};export default C;
